<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ParaView: Develop ParaView with Git</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea" style="height: 56px;">
  <div class="pv-title-cpp title-line">
    <div class="title-line">
      <img class="pv-logo" src="paraview-logo-small.png" />
    </div>
    <div class="langSwitch title-line"></div>
  </div>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search');
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Develop ParaView with Git </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This page documents how to develop ParaView using <a href="https://gitlab.kitware.com/">GitLab</a> and <a href="http://git-scm.com">Git</a>. See the <a class="el" href="Testing_2README_8md.html">README</a> for more information.</p>
<p>Git is an extremely powerful version control tool that supports many different "workflows" for individual development and collaboration. Here we document procedures used by the ParaView development community. In the interest of simplicity and brevity we do <em>not</em> provide an explanation of why we use this approach.</p>
<h2>Initial Setup </h2>
<p>Before you begin, perform initial setup:</p>
<ol type="1">
<li>Register <a href="https://gitlab.kitware.com/users/sign_in">GitLab Access</a> to create an account and select a user name.</li>
<li><a href="https://gitlab.kitware.com/paraview/paraview/-/forks/new">Fork ParaView</a> into your user's namespace on GitLab.</li>
<li><p class="startli">Follow the <a href="download.md#clone">download instructions</a> to create a local clone of the main ParaView repository. </p><pre class="fragment">$ git clone --recursive https://gitlab.kitware.com/paraview/paraview.git ParaView
</pre><p class="startli">The main repository will be configured as your <code>origin</code> remote.</p>
</li>
<li><p class="startli">Run the <a href="/Utilities/SetupForDevelopment.sh">developer setup script</a> to prepare your ParaView work tree and create Git command aliases used below: </p><pre class="fragment">$ ./Utilities/SetupForDevelopment.sh
</pre><p class="startli">This will prompt for your GitLab username and configure a remote called <code>gitlab</code> to refer to your fork. It will also setup a data directory for you. No need to do anything else.</p>
</li>
</ol>
<h2>Quick Start Guide </h2>
<p>This is a quick start guide so that you can start contributing to ParaView easily. To understand the process more deeply, you can jump to the <a href="#workflow">workflow</a> section.</p>
<h3>Developement</h3>
<p>Create a local branch for your changes:</p>
<div class="fragment"><div class="line">git checkout -b your_branch</div></div><!-- fragment --><p>Make the needed changes in ParaView and use git locally to create logically separated commits. There is no strict requirements regarding git commit messages syntax but a good rule of thumb to follow is: <code>General domain: reason for change</code>, General domain being a class, a module , a specific system like build or CI.</p>
<div class="fragment"><div class="line">git commit -m &quot;General domain: Short yet informative reason for the change&quot;</div></div><!-- fragment --><p>Build ParaView following the <a href="Documentation/dev/build.md#">guide</a> and fix any build warnings or issues that arise and seems related to your changes.</p>
<h3>Bringing in VTK changes</h3>
<p>If you are working on a change that is across both VTK and ParaView, you can work directly on the VTK that is inside your repository of ParaView. Just follow the steps in the <a href="https://gitlab.kitware.com/vtk/vtk/-/blob/master/Documentation/dev/git/develop.md#initial-setup">VTK develop guide</a> starting at the usage of <code>SetupForDevelopment.sh</code> script.</p>
<p>You can then develop in the VTK directory as if it was any VTK repository, where you can make changes, commit and push to your VTK fork.</p>
<p>If you want to test the integration of your VTK changes in ParaView [continuous integration](continuous-integration), commit and push your changes to your VTK fork, then commit the VTK submodule update with your changes in a separate commit in your ParaView branch. Your VTK commit will be found without issue.</p>
<p>Once your VTK changes are merged into VTK master, you can cleanup your history and commit the submodule update cleanly like this (this will remove local non commited changes and also rebase your branch on the last master):</p>
<div class="fragment"><div class="line">cd VTK</div><div class="line">git fetch origin</div><div class="line">git checkout master</div><div class="line">git pull</div><div class="line">cd ../</div><div class="line">git fetch origin</div><div class="line">git rebase -i origin/master # delete any VTK submodule update commit</div><div class="line">git submodule update</div><div class="line">git bump VTK master</div></div><!-- fragment --><h3>Testing</h3>
<p>Every change and new features needs to be tested. In ParaView, there are mainly two types of tests. Python tests and XML tests. While both types of tests are as valid to add, XML tests should be preferred for standard feature tests when possible as they exercise the ParaView user interface as well as core features.</p>
<h4>XML Tests</h4>
<p>First, as XML tests are impacted by ParaView's user settings, it is recommanded to always run <code>paraview</code> in dry run (option <code>--dr</code>).</p>
<p>To add a XML test, use the <code>Tools -&gt; Record <a class="elRef" doxygen="/builds/gitlab-kitware-sciviz-ci/build/Utilities/Doxygen/vtkNightlyDoc.tag:http://www.vtk.org/doc/nightly/html/" href="http://www.vtk.org/doc/nightly/html/classTest.html">Test</a></code> menu in ParaView. After specifying name for the XML test, a new window named <code>Recording User Input</code> will pop up. This one will record every action you will perfom in ParaView to test his feature.</p>
<p>It is also recommanded to lock the view size when we want to create a baseline, choose <code>Tools -&gt; Lock View Size Custom...</code> and set it to a 400x400 window as it works well.</p>
<p>On top of recording actions, the most important feature in this window is the check mark button which allows you to:</p><ul>
<li>record the value of a property in the Properties Panel.</li>
<li>save an intermediary baseline. (in that case, use <code>TESTS_WITH_INLINE_COMPARES</code>)</li>
<li>check any value in the spreadsheet view.</li>
</ul>
<p>Advanced features are:</p><ul>
<li><code>Continuous Flush</code>: writes events to file as soon as they are recorded. Especially useful when user environment isn't stable.</li>
<li><code>Record Interaction Timings</code>: record each pause between interactions as a pause event.</li>
</ul>
<p>It is also possible to stop the test recording by using the pause button and add comments in the XML test.</p>
<p>Finally, you can save the XML test by using the <code>Stop recording</code> button.</p>
<p>You may need to edit this file slightly to make it work as expected, do not hesitate to look at other files.</p>
<p>Add the file to <code>Client/ParaView/Testing/XML</code> folder and list it in one of the <code>test.XXX.cmake</code> file. Those files are conditionally used, typically depending on a build option. Look at <code>Client/ParaView/Testing/XML/CMakeLists.txt</code> to find the appropriate one. By default, tests should be added in <code><a class="el" href="test_8common_8cmake.html">test.common.cmake</a></code>.</p>
<p>There are different categories of tests depending on what you want to test :</p><ul>
<li><code>DATA_WITH_BASELINES</code>: for general use case, in most of the case the safest bet is this category.</li>
<li><code>TESTS_WITH_INLINE_COMPARES</code>: for when you need to do multiple image comparison.</li>
<li><code>TESTS_WITHOUT_BASELINES</code>: in some context, a valid XML test can be made without baseline.</li>
</ul>
<p>You can then configure ParaView and run your test from the build directory and check that they pass:</p>
<div class="fragment"><div class="line">cmake . &amp;&amp; cmake --build .</div><div class="line">ctest -VV -R yourTest</div></div><!-- fragment --><h4>Python Tests</h4>
<p>To add a Python test, write a pvpython script testing the feature, add it in <code>Client/ParaView/Testing/Python</code> folder and list it in <code>Client/ParaView/Testing/Python/CMakeLists.txt</code>. There are different categories of tests, but the safest bet is probably the <code>paraview_add_test_python</code> category.</p>
<div class="fragment"><div class="line">cmake . &amp;&amp; cmake --build .</div><div class="line">ctest -VV -R yourTest</div></div><!-- fragment --><h3>Upload</h3>
<p>Push your changes to the gitlab fork that you created in the <a href="#initial-setup">initial setup</a> stage:</p>
<div class="fragment"><div class="line">git push gitlab</div></div><!-- fragment --><h3>Data</h3>
<p>If your test uses new data or baselines, you will need to add it to your fork. For data, add the file names to the list in the corresponding <code>Clients/ParaView/Testing/Python/CMakeLists.txt</code> or <code><a class="el" href="test_8common_8cmake.html">Clients/ParaView/Testing/XML/test.common.cmake</a></code> and drop the files in <code>Testing/Data/</code>. For baselines, just drop the file in <code>Clients/ParaView/Testing/Data/Baseline/</code> and run the following commands from your build directory:</p>
<div class="fragment"><div class="line">cmake . &amp;&amp; cmake --build .</div></div><!-- fragment --><p>This will transform your files into .sha512 files. Check your test is passing by running from your build directory:</p>
<div class="fragment"><div class="line">ctest -VV -R yourTest</div></div><!-- fragment --><p>If it passes, add these .sha512 files and commit them, then push with:</p>
<div class="fragment"><div class="line">git gitlab-push</div></div><!-- fragment --><h3>Create a Merge Request</h3>
<p>Once you are happy with the state of your development on your fork, the next step is to create a merge request back into the main ParaView repository.</p>
<p>Open [](<a href="https://gitlab.kitware.com/username/paraview/-/merge_requests/new">https://gitlab.kitware.com/username/paraview/-/merge_requests/new</a>) in a browser, select your branch in the list and create a Merge Request against master.</p>
<p>In the description, write an informative explanation of your added features or bugfix. If there is an associated issue, link it with the <code>#number</code> in the description.</p>
<p>Tag some ParaView maintainers in the description to ensure someone will see it, eg: .quammen, .boeckel or .</p>
<h3>Robot Checks</h3>
<p>Once the MR is created, our gitlab robot will check multiple things and make automated suggestions. Please read them and try to follow the instructions. The two standard suggestions are related to formatting errors and adding markdown changelog.</p>
<p>To fix the formatting, just add a comment containing:</p>
<div class="fragment"><div class="line">Do: reformat</div></div><!-- fragment --><p>Then, once the robot has fixed the formatting, fetch the changes locally (this will remove any local changes to your branch)</p>
<div class="fragment"><div class="line">git fetch gitlab</div><div class="line">git reset --hard gitlab/your_branch</div></div><!-- fragment --><p>To fix the changelog warning, create, add, commit and push a markdown (.md) file in <code>Documentation/release/dev</code> folder. In this file, write a small markdown paragraph describing the development. See other .md files in this folder for examples. It may look like this:</p>
<div class="fragment"><div class="line">## Development title</div><div class="line"></div><div class="line">A new feature that does this and that has been introduced.</div><div class="line">This specific issue has been fixed in this particular way.</div></div><!-- fragment --><p>Suggestions and best practices on writing the changelog can be found in the <code>Documentation/release/dev/0-sample-topic.md</code> file. This is an optional step but recommended to do for any new feature and user facing issues.</p>
<h3>Reviews</h3>
<p>ParaView maintainers and developers will review your MR by leaving comments on it. Try to follow their instructions and be patient. It can take a while to get a MR into mergeable form. This is a mandatory step, and it is absolutely normal to get change requests.</p>
<p>Review comments can be resolved, please resolve a comment once you've taken it into account and pushed related changes or once you've reached an agreement with the commenter that nothing should be changed.</p>
<p>Once a reviewer is happy with your changes, they will add a <code>+X</code> comment. You need at least one <code>+2</code> or higher to consider merging the MR. Two <code>+1</code>s do not equal a <code>+2</code>. If a reviewer leave a <code>-1</code> comment, please discuss with them to understand what is the issue and how it could be fixed.</p>
<p>Once you have pushed new changes, please tag reviewers again so that they can take a look. If you do not tag reviewers, they may not know to revisit your changes. <em>Do not hesitate to tag them and ask for help</em>.</p>
<h3>Continuous Integration</h3>
<p>Before merging a MR, the ParaView continuous integration (CI) needs to run and be green. For CI to be functional, please read and follow this <a href="https://discourse.vtk.org/t/the-ultimate-how-to-make-ci-work-with-my-fork-guide/7581">guide</a>. It was written for VTK but is as valid for ParaView.</p>
<p>To run the CI:</p><ul>
<li>Click on the Pipelines Tab</li>
<li>Click on the last pipeline status badge</li>
<li>Press the <code>Play all manual</code> arrows on top of the Build and <a class="elRef" doxygen="/builds/gitlab-kitware-sciviz-ci/build/Utilities/Doxygen/vtkNightlyDoc.tag:http://www.vtk.org/doc/nightly/html/" href="http://www.vtk.org/doc/nightly/html/classTest.html">Test</a> stages</li>
</ul>
<p>Do not hesitate to tag a ParaView developer for help if needed.</p>
<p>You then need to wait for CI to run, it can take a while, up to a full day.</p>
<p>A successful CI should be fully green. If that is so, then your MR is ready !</p>
<p>If not, you need to analyze the issues and fix them. Recover the failure information this way:</p>
<p>Click on the pipelines tab, then on the last status badge, then on the <code>cdash-commit</code> job. It will take you to the related CDash report where you will find all information.</p>
<p>Everything in the CDash report should be green except the <code>NotRun</code> and <code>Time</code> column. Take a look into each issue and fix them locally. If there are issues in the pipeline but nothing is visible in the CDash, please ask a maintainer for help to figure out if anything should be done. You can always try to rerun the failed job by clicking on the arrow of the job in the pipeline.</p>
<p>Once you have fixed some issues locally, commit and push them to gitlab, run the CI again and tag reviewers again for follow-up reviews.</p>
<h3>Merging</h3>
<p>Once the MR has green CI and you have at least one <code>+2</code>, you can ask for a merge. Before that please make sure that:</p><ul>
<li>Your commit history is logical (or squashed into a single commit) and cleaned up with good commit messages</li>
<li>You are rebased on a fairly recent version of master</li>
</ul>
<p>If that is not the case, please rebase on master using the following commands:</p>
<div class="fragment"><div class="line">git fetch origin</div><div class="line">git rebase -i origin/master</div><div class="line">git push gitlab -f</div></div><!-- fragment --><p>The interactive rebase will let you squash commits, reorganize commits and edit commit messages.</p>
<p>After the force push, make sure to run CI again.</p>
<p>Once all is done, tag a ParaView developer so that they can perform the merge command.</p>
<p><b>Congratulations ! You just contributed to ParaView !</b></p>
<h2>Workflow </h2>
<p>ParaView development uses a <a href="http://public.kitware.com/Wiki/Git/Workflow/Topic">branchy workflow</a> based on topic branches. Our collaboration workflow consists of three main steps:</p>
<ol type="1">
<li>Local Development:<ul>
<li><a href="#update">Update</a></li>
<li><a href="#create-a-topic">Create a Topic</a></li>
</ul>
</li>
<li>Code Review (requires <a href="https://gitlab.kitware.com/users/sign_in">GitLab Access</a>):<ul>
<li><a href="#share-a-topic">Share a Topic</a></li>
<li><a href="#create-a-merge-request">Create a Merge Request</a></li>
<li><a href="#review-a-merge-request">Review a Merge Request</a></li>
<li><a href="#revise-a-topic">Revise a Topic</a></li>
</ul>
</li>
<li>Integrate Changes:<ul>
<li><a href="#merge-a-topic">Merge a Topic</a> (requires permission in GitLab)</li>
<li><a href="#delete-a-topic">Delete a Topic</a></li>
</ul>
</li>
</ol>
<h2>Update </h2>
<ol type="1">
<li>Update your local <code>master</code> branch: <pre class="fragment">$ git checkout master
$ git pullall
</pre></li>
<li>Optionally push <code>master</code> to your fork in GitLab: <pre class="fragment">$ git push gitlab master
</pre> to keep it in sync. The <code>git gitlab-push</code> script used to <a href="#share-a-topic">Share a Topic</a> below will also do this.</li>
</ol>
<h2>Create a Topic </h2>
<p>All new work must be committed on topic branches. Name topics like you might name functions: concise but precise. A reader should have a general idea of the feature or fix to be developed given just the branch name. Additionally, it is preferred to have an issue associated with every topic. The issue can document the bug or feature to be developed. In such cases, being your topic name with the issue number.</p>
<ol type="1">
<li><p class="startli">To start a new topic branch: </p><pre class="fragment">$ git fetch origin
</pre><p class="startli">If there is an issue associated with the topic, assign the issue to yourself using the "**Assignee**" field, and add the <code>workflow:active-development</code> label to it.</p>
</li>
<li><p class="startli">For new development, start the topic from <code>origin/master</code>: </p><pre class="fragment">$ git checkout -b my-topic origin/master
</pre><p class="startli">For release branch fixes, start the topic from <code>origin/release</code>, and by convention use a topic name starting in <code>release-</code>: </p><pre class="fragment">$ git checkout -b release-my-topic origin/release
</pre><p class="startli">If subdmodules may have changed, the run: </p><pre class="fragment">$ git submodule update
</pre></li>
<li><p class="startli">Edit files and create commits (repeat as needed): </p><pre class="fragment">$ edit file1 file2 file3
$ git add file1 file2 file3
$ git commit
</pre><p class="startli">Caveats:</p><ul>
<li>To add data follow these https://gitlab.kitware.com/vtk/vtk/-/blob/master/Documentation/dev/git/data.md "vtk instructions".</li>
<li>To add icons, Kitware's graphic designer may be able to help create an SVG icon.</li>
</ul>
<p class="startli">Commit messages must contain a brief description as the first line and a more detailed description of what the commit contains. If the commit contains a new feature, the detailed message must describe the new feature and why it is needed. If the commit contains a bug fix, the detailed message must describe the bug behavior, its underlying cause, and the approach to fix it. If the bug is described in the bug tracker, the commit message must contain a reference to the bug number.</p>
</li>
<li><p class="startli">Update a submodule if needed</p>
<p class="startli">If you need to update a submodule (eg: VTK) in order to access a specific bugfix or features, first make sure that the needed developments have been merged into the main branch of the submodule. You can then use the command: </p><pre class="fragment">$ git bump my-submodule my-hash-or-branch
</pre><p class="startli"><code>my-submodule</code> being the submodule folder (eg: VTK), <code>my-hash-or-branch</code> being either a hash or a branch provided by any of your remote or your local repository, typically, <code>origin/master</code>.</p>
<p class="startli">This will add a new commit which update the submodule and prefill the commit message with information about the different commits in the submodule. Make sure to still add some information about the reason for the bump.</p>
<p class="startli">Please note you can run CI on a submodule commit in another remote, see [continuous integration] for more info.</p>
</li>
</ol>
<ol type="1">
<li><p class="startli">Add some tests</p>
<p class="startli">Every changes and new features need to be tested in ParaView. Depending on what you implement, you can perform an image comparison with a baseline of expected result or checking a property at anytime.</p>
<p class="startli">They are mainly 2 types of test in ParaView, python and XML testing. Generally we use a XML test, for more details regarding this topic, it's highly recommanded to check this <a href="#testing">section</a>.</p>
</li>
<li><p class="startli">Add release notes</p>
<p class="startli">Notable changes should create a new file in <code>Documentation/release/dev/</code> named <code>my-topic.md</code> (replace <code>my-topic</code> with the name of your topic). This is not necessary for branches which are "trivial" such as fixing typos, updating test baselines, or are developer-oriented.</p>
</li>
</ol>
<h2>Share a Topic </h2>
<p>When a topic is ready for review and possible inclusion, share it by pushing to a fork of your repository in GitLab. Be sure you have registered and signed in for <a href="https://gitlab.kitware.com/users/sign_in">GitLab Access</a> and created your fork by visiting the main <a href="https://gitlab.kitware.com/paraview/paraview">ParaView GitLab</a> repository page and using the "Fork" button in the upper right.</p>
<ol type="1">
<li>Checkout the topic if it is not your current branch: <pre class="fragment">$ git checkout my-topic
</pre></li>
<li>Check what commits will be pushed to your fork in GitLab: <pre class="fragment">$ git prepush
</pre></li>
<li><p class="startli">Push commits in your topic branch to your fork in GitLab: </p><pre class="fragment">$ git gitlab-push
</pre><p class="startli">Notes:</p><ul>
<li>If you are revising a previously pushed topic and have rewritten the topic history, add <code>-f</code> or <code>--force</code> to overwrite the destination.</li>
<li>If the topic adds data see <a href="https://gitlab.kitware.com/vtk/vtk/-/blob/master/Documentation/dev/git/data.md#push">this note</a>.</li>
<li>The <code>gitlab-push</code> script also pushes the <code>master</code> branch to your fork in GitLab to keep it in sync with the upstream <code>master</code>.</li>
</ul>
<p class="startli">The output will include a link to the topic branch in your fork in GitLab and a link to a page for creating a Merge Request.</p>
</li>
</ol>
<h2>Create a Merge Request </h2>
<p>(If you already created a merge request for a given topic and have reached this step after revising it, skip to the <a href="#review-a-merge-request">next step</a>.)</p>
<p>Visit your fork in GitLab, browse to the "**Merge Requests**" link on the left, and use the "**New Merge Request**" button in the upper right to reach the URL printed at the end of the <a href="#share-a-topic">previous step</a>. It should be of the form: </p><pre class="fragment">https://gitlab.kitware.com/&lt;username&gt;/paraview/-/merge_requests/new
</pre><p>Follow these steps:</p>
<ol type="1">
<li>In the "**Source branch**" box select the <code>&lt;username&gt;/paraview</code> repository and the <code>my-topic</code> branch.</li>
<li><p class="startli">In the "**Target branch**" box select the <code>paraview/paraview</code> repository and the <code>master</code> branch. It should be the default.</p>
<p class="startli">If your change is a fix for the <code>release</code> branch, you should still select the <code>master</code> branch as the target because the change needs to end up there too.</p>
</li>
<li>Use the "**Compare branches**" button to proceed to the next page and fill out the merge request creation form.</li>
<li><p class="startli">In the "**Title**" field provide a one-line summary of the entire topic. This will become the title of the Merge Request.</p>
<p class="startli">Example Merge Request Title: </p><pre class="fragment">Wrapping: Add Java 1.x support
</pre></li>
<li><p class="startli">In the "**Description**" field provide a high-level description of the change the topic makes and any relevant information about how to try it.</p><ul>
<li>Use <code>@username</code> syntax to draw attention of specific developers. This syntax may be used anywhere outside literal text and code blocks. Or, wait until the <a href="#review-a-merge-request">next step</a> and add comments to draw attention of developers.</li>
<li>If your change is a fix for the <code>release</code> branch, indicate this so that a maintainer knows it should be merged to <code>release</code>.</li>
<li>Optionally use a fenced code block with type <code>message</code> to specify text to be included in the generated merge commit message when the topic is <a href="#merge-a-topic">merged</a>.</li>
</ul>
<p class="startli">Example Merge Request Description: </p><pre class="fragment">This branch requires Java 1.x which is not generally available yet.
Get Java 1.x from ... in order to try these changes.

```message
Add support for Java 1.x to the wrapping infrastructure.
```

Cc: @user1 @user2
</pre></li>
<li>The "**Assign to**", "**Milestone**", and "**Labels**" fields may be left blank.</li>
<li>Use the "**Submit merge request**" button to create the merge request and visit its page.</li>
</ol>
<h2>Guidelines </h2>
<p>For guidelines with respect to licensing, naming conventions, code formatting, documentation and further, please check <a class="el" href="guidelines_8md.html">guidelines</a></p>
<h2>Review a Merge Request </h2>
<p>Add comments mentioning specific developers using <code>@username</code> syntax to draw their attention and have the topic reviewed. After typing <code>@</code> and some text, GitLab will offer completions for developers whose real names or user names match.</p>
<p>Comments use <a href="https://gitlab.kitware.com/help/markdown/markdown">GitLab Flavored Markdown</a> for formatting. See GitLab documentation on <a href="https://gitlab.kitware.com/help/markdown/markdown#special-gitlab-references">Special GitLab References</a> to add links to things like merge requests and commits in other repositories.</p>
<p>When a merge request is ready for review, developers can use the <code>triage:ready-for-review</code> to indicate the same to the reviewers. If reviewers deems that it needs more work, they can add the <code>triage:needswork</code> label. This can be repeated as many times as needed adding/removing labels as appropriate.</p>
<p>If a merge request is waiting on dashboards, use the <code>triage:pending-dashboards</code> label.</p>
<h3>Human Reviews</h3>
<p>Reviewers may add comments providing feedback or to acknowledge their approval.</p>
<p>If a reviewer raises an issue via a thread, the contributor may resolve the thread if the solution is indisputable. In case of cited lines within the issue, the corresponding changes of the commit prior to a comment are shown. So it is better to first push the change and then comment/resolve. When code is cited, the last line is usually the line of interest, the above lines just provide the context. Providing a comment just saying 'done' is unnecessary as GitLab will indicate that the relevant code has changed.</p>
<p>It shall be a common goal for reviewers and contributors to limit the amount of generated emails. Therefore reviewers are encouraged to comment systematic issues (e.g. missing <code>this-&gt;</code>) only once but to indicate the general application. Contributors do not need to comment on trivial fixes (e.g. typos in comments) but may simply solved the threads after fixing.</p>
<p>To raise the attention of individuals, e.g. a reviewer for another round of review, this person can be pinged by addressing via <code>@</code> in a comment.</p>
<h4>Special Comments</h4>
<p>Lines of specific forms will be extracted during <a href="#merge-a-topic">merging</a> and included as trailing lines of the generated merge commit message:</p>
<p>The <em>leading</em> line of a comment may optionally be exactly one of the following votes followed by nothing but whitespace before the end of the line:</p>
<ul>
<li><code>-1</code> or <code>:-1:</code> indicates "the change is not ready for integration".</li>
<li><code>+1</code> or <code>:+1:</code> indicates "I like the change". This adds an <code>Acked-by:</code> trailer to the merge commit message.</li>
<li><code>+2</code> indicates "the change is ready for integration". This adds a <code>Reviewed-by:</code> trailer to the merge commit message.</li>
<li><code>+3</code> indicates "I have tested the change and verified it works". This adds a <code>Tested-by:</code> trailer to the merge commit message.</li>
</ul>
<p>The middle lines of a comment may be free-form <a href="https://gitlab.kitware.com/help/markdown/markdown">GitLab Flavored Markdown</a>.</p>
<p>Zero or more <em>trailing</em> lines of a comment may each contain exactly one of the following votes followed by nothing but whitespace before the end of the line:</p>
<ul>
<li><code>Rejected-by: me</code> means "The change is not ready for integration."</li>
<li><code>Acked-by: me</code> means "I like the change but defer to others."</li>
<li><code>Reviewed-by: me</code> means "The change is ready for integration."</li>
<li><code>Tested-by: me</code> means "I have tested the change and verified it works."</li>
</ul>
<p>Each <code>me</code> reference may instead be an <code>@username</code> reference or a full <code>Real Name &lt;user@domain&gt;</code> reference to credit someone else for performing the review. References to <code>me</code> and <code>@username</code> will automatically be transformed into a real name and email address according to your GitLab account profile.</p>
<h4>Fetching Changes</h4>
<p>One may fetch the changes associated with a merge request by using the <code>git fetch</code> command line shown at the top of the Merge Request page. It is of the form: </p><pre class="fragment">$ git fetch https://gitlab.kitware.com/$username/paraview.git $branch
</pre><p>This updates the local <code>FETCH_HEAD</code> to refer to the branch.</p>
<p>There are a few options for checking out the changes in a work tree:</p>
<ul>
<li>One may checkout the branch: <pre class="fragment">$ git checkout FETCH_HEAD -b $branch
</pre> or checkout the commit without creating a local branch: <pre class="fragment">$ git checkout FETCH_HEAD
</pre></li>
<li>Or, one may cherry-pick the commits to minimize rebuild time: <pre class="fragment">$ git cherry-pick ..FETCH_HEAD
</pre></li>
</ul>
<h3>Robot Reviews</h3>
<p>The "Kitware Robot" automatically performs basic checks including clang-format on the commits and adds a comment acknowledging or rejecting the topic. This will be repeated automatically whenever the topic is pushed to your fork again.</p>
<p>Automatic formatting can be triggered by adding a comment with a single line. </p><pre class="fragment">Do: reformat
</pre><p>A re-check may be explicitly requested by </p><pre class="fragment">Do: check
</pre><p>A topic cannot be <a href="#merge-a-topic">merged</a> until the automatic review succeeds. It is necessary to correct the specific commit via rebase.</p>
<h3>Continuous Integration</h3>
<p>ParaView uses https://gitlab.kitware.com/help/ci/README.md "GitLab CI" to test merge requests, configured by the top-level <code>.gitlab-ci.yml</code> file. Results may be seen both on the merge request's pipeline page and on the <a href="https://open.cdash.org/index.php?project=ParaView">ParaView CDash Page</a>. Filtered CDash results showing just the pipeline's jobs can be reached by selecting the <code>cdash-commit</code> job in the <code>External</code> stage of the pipeline. Note that due to GitLab changes, the <code>External</code> stage may be in a separate pipeline for the same commit.</p>
<p>Lint build jobs run automatically after every push. Actual CI jobs require a manual trigger to run:</p>
<ul>
<li>Merge request authors may visit their merge request's pipeline and click the "Play" button on one or more jobs manually. If the merge request has the "Allow commits from members who can merge to the target branch" check box enabled, ParaView maintainers may use the "Play" button too. When in doubt, it's a good idea to run a few jobs as smoke tests to catch early build/test failures before a full CI run that would tie up useful resources. Note that, as detailed below, a full CI run is necessary before the request can be merged.</li>
<li>When working simultaneously on ParaView and a submodule, e.g., VTK, it may be useful to run the CI before merging changes in the submodule in question. This is perfectly supported, just push your change on your remote for the submodule and update the submodule manually in a temporary commit, then run the CI. Make sure to remove this commit before the merge and use <code>git bump</code> when performing the actual submodule update.</li>
<li><p class="startli"><a href="https://gitlab.kitware.com/cmake/cmake/-/settings/members">ParaView GitLab Project Developers</a> may trigger CI on a merge request by adding a comment with a command among the <a href="#trailing-lines">comment trailing lines</a>: </p><pre class="fragment">  Do: test
</pre><p class="startli"><code>@kwrobot</code> will add an award emoji to the comment to indicate that it was processed and also trigger all manual jobs in the merge request's pipeline.</p>
<p class="startli">The <code>Do: test</code> command accepts the following arguments:</p><ul>
<li><code>--named &lt;regex&gt;</code>, <code>-n &lt;regex&gt;</code>: Trigger jobs matching <code>&lt;regex&gt;</code> anywhere in their name. Job names may be seen on the merge request's Pipelines tab.</li>
<li><code>--stage &lt;stage&gt;</code>, <code>-s &lt;stage&gt;</code>: Only affect jobs in a given stage. Stage names may be seen on the merge request's Pipelines tab. Note that the names are determined by what is in the <code>.gitlab-ci.yml</code> file and may be capitalized in the web page, so lowercasing the webpage's display name for stages may be required.</li>
<li><code>--action &lt;action&gt;</code>, <code>-a &lt;action&gt;</code>: The action to perform on the jobs. Possible actions:<ul>
<li><code>manual</code> (the default): Start jobs awaiting manual interaction.</li>
<li><code>unsuccessful</code>: Start or restart jobs which have not completed successfully.</li>
<li><code>failed</code>: Restart jobs which have completed, but without success.</li>
<li><code>completed</code>: Restart all completed jobs.</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>If the merge request topic branch is updated by a push, a new manual trigger using one of the above methods is needed to start CI again. Currently running jobs will generally be canceled automatically.</p>
<p>Before the merge, all the jobs must be run and reviewed, see below.</p>
<p>If you have any question about the CI process, do not hesitate to ask a CI maintainer:</p><ul>
<li>ben.boeckel</li>
<li>mwestphal</li>
</ul>
<h3>Reading CI Results</h3>
<p>Reading CI results is a very important part of the merge request process and is the responsibility of the author of the merge request, although reviewers can usually help. There are two locations to read the results, GitLab CI and CDash. Both should be checked and considered clean before merging.</p>
<p>To read GitLab CI result, click on the Pipelines tab then on the last pipeline. It is expected to be fully green. If there is a yellow warning job, please consult CDash. If there is a red failed job, click on it to see the reason for the failure. It should clearly appears on the bottom of the log. Possible failures are:</p><ul>
<li>Timeouts: please rerun the job and report to CI maintainers</li>
<li>Memory related errors: please rerun the job and report to CI maintainers</li>
<li>Testing errors: please consult CDash for more information, usually an issue in your code</li>
<li>Non disclosed error: please consult CDash, usually a build error in your code</li>
</ul>
<p>To read the CDash results, on the job page, click on the "cdash-commit" external job which will open the commit-specific CDash page. Once it is open, make sure to show "All Build" at the bottom left of the page. CDash results display error, warnings, and test failures for all the jobs. It is expected to be green <em>except</em> for the "NoRun" and "Test Timings" categories, which can be ignored.</p>
<ul>
<li>Configure warnings: there <b>must</b> not be any; to fix before the merge</li>
<li>Configure errors: there <b>must</b> not be any; to fix before the merge</li>
<li>Build warnings: there <b>must</b> not be any; to fix before the merge. If unrelated to your code, rerun the job and report to CI maintainers.</li>
<li>Build Errors: there <b>must</b> not be any; to fix before the merge. If unrelated to your code, report to CI maintainers.</li>
<li>NotRun test: ignore; these tests have self-diagnosed that they are not relevant on the testing machine.</li>
<li>Testing failure: there <b>should</b> not be any, ideally, to fix before the merge. If unrelated to your code, check the test history to see if it is a flaky test and report to CI maintainers.</li>
<li>Testing success: if your MR creates or modifies tests, please check that your test are listed there.</li>
<li><a class="elRef" doxygen="/builds/gitlab-kitware-sciviz-ci/build/Utilities/Doxygen/vtkNightlyDoc.tag:http://www.vtk.org/doc/nightly/html/" href="http://www.vtk.org/doc/nightly/html/classTest.html">Test</a> timings errors: can be ignored, but if it is all red, you may want to report it to CI maintainers.</li>
</ul>
<p>To check the history of a failing test, on the test page, click on the "Summary" link to see a summary of the test for the day, then click on the date controls on the top of the page to go back in time. If the test fails on other MRs or on master, this is probably a flaky test, currently in the process of being fixed or excluded. A flaky test can be ignored.</p>
<p>As a reminder, here is our current policy regarding CI results. All the jobs must be run before merging. Configure warnings and errors are not acceptable to merge and must be fixed. Build warning and errors are not acceptable to merge and must be fixed. Testing failure should be fixed before merging but can be accepted if a flaky test has been clearly identified.</p>
<h2>Revise a Topic </h2>
<p>If a topic is approved during GitLab review, skip to the <a href="#merge-a-topic">next step</a>. Otherwise, revise the topic and push it back to GitLab for another review as follows:</p>
<ol type="1">
<li>Checkout the topic if it is not your current branch: <pre class="fragment">$ git checkout my-topic
</pre></li>
<li><p class="startli">To revise the <code>3</code>rd commit back on the topic: </p><pre class="fragment">$ git rebase -i HEAD~3
</pre><p class="startli">(Substitute the correct number of commits back, as low as <code>1</code>.) Follow Git's interactive instructions.</p>
</li>
<li>Return to the <a href="#share-a-topic">above step</a> to share the revised topic.</li>
</ol>
<h2>Merge a Topic </h2>
<p>Once review has concluded that the MR topic is ready for integration (at least one <code>+2</code>), authorized developers may add a comment with a single <a href="#trailing-lines"><em>trailing</em> line</a>: </p><pre class="fragment">Do: merge
</pre><p>to ask that the change be merged into the upstream repository. By convention, do not request a merge if any <code>-1</code> or <code>Rejected-by:</code> review comments have not been resolved and superseded by at least <code>+1</code> or <code>Acked-by:</code> review comments from the same user.</p>
<p>Developers are encouraged to merge their own merge requests on review. However, please do not merge unless you are available to address any dashboard issues that may arise. Developers who repeatedly ignore dashboard issues following their merges may loose developer privileges to the repository temporarily (or permanently)!</p>
<h3>Merge Success</h3>
<p>If the merge succeeds the topic will appear in the upstream repository <code>master</code> branch and the Merge Request will be closed automatically. Any issues associated with the Merge Request will generally get closed automatically. If not, the developer merging the changes should close such issues and add a <code>workflow:customer-review</code> tag to the issue(s) addressed by the change. Reporters and testers can then review the fix. Try to add enough information to the Issue or the Merge Request to indicate how to test the functionality if not obvious from the original Issue.</p>
<h3>Merge Failure</h3>
<p>If the merge fails (likely due to a conflict), a comment will be added describing the failure. In the case of a conflict, fetch the latest upstream history and rebase on it: </p><pre class="fragment">$ git fetch origin
$ git rebase origin/master
</pre><p>(If you are fixing a bug in the latest release then substitute <code>origin/release</code> for <code>origin/master</code>.)</p>
<p>Return to the <a href="#share-a-topic">above step</a> to share the revised topic.</p>
<h2>Delete a Topic </h2>
<p>After a topic has been merged upstream the Merge Request will be closed. Now you may delete your copies of the branch.</p>
<ol type="1">
<li>In the GitLab Merge Request page a "**Remove Source Branch**" button will appear. Use it to delete the <code>my-topic</code> branch from your fork in GitLab.</li>
<li>In your work tree checkout and update the <code>master</code> branch: <pre class="fragment">$ git checkout master
$ git pull
</pre></li>
<li><p class="startli">Delete the local topic branch: </p><pre class="fragment">$ git branch -d my-topic
</pre><p class="startli">The <code>branch -d</code> command works only when the topic branch has been correctly merged. Use <code>-D</code> instead of <code>-d</code> to force the deletion of an unmerged topic branch (warning - you could lose commits).</p>
</li>
</ol>
<h2>Contribute VTK Changes </h2>
<p>If you have any VTK changes, then you are required to get your changes incorporated into VTK using <a href="https://gitlab.kitware.com/vtk/vtk/-/tree/master/Documentation/dev/git">VTK's development workflow</a>. Once your VTK topic has been approved and merged into VTK, then:</p>
<ol type="1">
<li>Create a <a href="#create-a-topic">ParaView topic</a> if you haven't already.</li>
<li>Add your VTK topic head (or the latest VTK origin/master which includes your VTK topic head). <pre class="fragment"> $ cd VTK
 $ git checkout master
 $ cd ..
 $ git add VTK
 $ git commit
</pre></li>
<li>Follow the merge process documented earlier. </li>
</ol>
</div></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13 on Mon Jul 15 2024
</small></address>
<!-- KW:BEGIN -->
<!-- this adds the version selection header -->
<script type="text/javascript" src="/paraview-docs/paraview-version.js"></script>
<!-- KW:END -->
</body>
</html>
